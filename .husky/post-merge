echo "ðŸ”„ Post-merge hook executed..."

# Check if package files changed during merge
if git diff-tree -r --name-only --no-commit-id ORIG_HEAD HEAD | grep -E '^(package\.json|package-lock\.json|yarn\.lock|pnpm-lock\.yaml)$' > /dev/null; then
  echo "ðŸ“¦ Dependency changes detected after merge, installing..."
  
  # Install dependencies
  if [ -f "pnpm-lock.yaml" ]; then
    pnpm install
  elif [ -f "yarn.lock" ]; then
    yarn install  
  else
    npm install
  fi
  
  echo "âœ… Dependencies updated after merge!"
fi

# Clean up any generated files that might conflict
if [ -d ".next" ]; then
  echo "ðŸ§¹ Cleaning Next.js cache..."
  rm -rf .next
fi

if [ -d "node_modules/.cache" ]; then
  echo "ðŸ§¹ Cleaning node modules cache..."
  rm -rf node_modules/.cache
fi

echo "âœ… Post-merge cleanup completed!"
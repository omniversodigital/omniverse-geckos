# Run lint-staged to check staged files
npx lint-staged

# Check for console.log in staged files (production safety)
if git diff --cached --name-only | grep -E '\.(js|jsx|ts|tsx)$' | xargs grep -l 'console\.\(log\|warn\|error\|info\)' > /dev/null 2>&1; then
  echo "‚ùå console.log/warn/error/info encontrado en archivos staged"
  echo "Remueve los console statements antes de hacer commit o usa --no-verify si es intencional"
  exit 1
fi

# Check for TODO/FIXME in critical files
if git diff --cached --name-only | grep -E 'src/(components|app|lib).*\.(js|jsx|ts|tsx)$' | xargs grep -l 'TODO\|FIXME' > /dev/null 2>&1; then
  echo "‚ö†Ô∏è  TODO/FIXME encontrado en archivos cr√≠ticos staged"
  echo "Resuelve estos comentarios antes de hacer commit o usa --no-verify si est√° OK"
fi

# Verify TypeScript compilation for staged files
echo "üîç Verificando compilaci√≥n TypeScript..."
npx tsc --noEmit || {
  echo "‚ùå Errores de TypeScript encontrados. Corr√≠gelos antes del commit."
  exit 1
}

echo "‚úÖ Pre-commit checks passed!"
# Get the previous and current HEAD, and checkout type
prev_head=$1
new_head=$2
checkout_type=$3

# Only run on branch checkout (not file checkout)
if [ "$checkout_type" = "1" ]; then
  echo "ğŸ”„ Branch checkout detected..."
  
  # Check if package.json or package-lock.json changed
  if git diff --name-only "$prev_head" "$new_head" | grep -E '^(package\.json|package-lock\.json|yarn\.lock|pnpm-lock\.yaml)$' > /dev/null; then
    echo "ğŸ“¦ Dependency changes detected, installing..."
    
    # Install dependencies
    if [ -f "pnpm-lock.yaml" ]; then
      pnpm install
    elif [ -f "yarn.lock" ]; then
      yarn install
    else
      npm install
    fi
    
    echo "âœ… Dependencies updated!"
  fi
  
  # Show helpful branch information
  echo "ğŸ“ Switched to branch: $(git branch --show-current)"
  echo "ğŸ“Š Latest commits:"
  git log --oneline -3
fi